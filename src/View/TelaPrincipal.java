/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package View;

import Controller.Conec;
import Controller.PostgresBackup;
import Model.Bovino;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.io.IOException;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.Date;
import java.util.Map;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.Icon;
import javax.swing.ImageIcon;
import javax.swing.JOptionPane;
import javax.swing.Timer;
import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JRResultSetDataSource;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.view.JasperViewer;

/**
 *
 * @author rodri
 */
public class TelaPrincipal extends javax.swing.JFrame {

    /**
     * Creates new form TelaPrincipal
     */
    Connection con = null;
    PreparedStatement pst = null;
    ResultSet rs = null;

    public TelaPrincipal() {
        initComponents();
        dataValor.setText(new SimpleDateFormat("dd/MM/yyyy").format(new Date(System.currentTimeMillis())));
        Timer timer = new Timer(1000, new hora());
        timer.start();

        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, e);
        }
        this.setIcon();

    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jDayChooser1 = new com.toedter.calendar.JDayChooser();
        logoTelaPrincipal = new javax.swing.JLabel();
        painelAT = new javax.swing.JPanel();
        AT_Bovino = new javax.swing.JButton();
        AT_USUARIO1 = new javax.swing.JButton();
        AT_fazenda = new javax.swing.JButton();
        AT_sair = new javax.swing.JButton();
        AT_backup = new javax.swing.JButton();
        AT_Cio = new javax.swing.JButton();
        AT_Confirmacao = new javax.swing.JButton();
        AT_Repetiu = new javax.swing.JButton();
        AT_Perdeu = new javax.swing.JButton();
        AT_Parto = new javax.swing.JButton();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        usuarioLogadoInfo = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        fazendaLogada1 = new javax.swing.JLabel();
        jLabel5 = new javax.swing.JLabel();
        proLogada1 = new javax.swing.JLabel();
        dataValor = new javax.swing.JLabel();
        DataL = new javax.swing.JLabel();
        horasValor = new javax.swing.JLabel();
        HoraL = new javax.swing.JLabel();
        menuBarra = new javax.swing.JMenuBar();
        cadastroM = new javax.swing.JMenu();
        bovinoM = new javax.swing.JMenuItem();
        fazendaM = new javax.swing.JMenuItem();
        usuarioM = new javax.swing.JMenuItem();
        eventosM = new javax.swing.JMenu();
        reproducaoM = new javax.swing.JMenu();
        cadastroCioM = new javax.swing.JMenuItem();
        cioRepetidoM = new javax.swing.JMenuItem();
        confirmaCioM = new javax.swing.JMenuItem();
        prePartoM = new javax.swing.JMenuItem();
        perdaCriaM = new javax.swing.JMenuItem();
        partoM = new javax.swing.JMenuItem();
        relatorioM = new javax.swing.JMenu();
        relcadastro = new javax.swing.JMenu();
        usuarioRel = new javax.swing.JMenuItem();
        rel_cad_bov = new javax.swing.JMenuItem();
        rel_quanti_perdas = new javax.swing.JMenu();
        previsaoParto = new javax.swing.JMenuItem();
        Cio_por_Vaca = new javax.swing.JMenuItem();
        relPreParto = new javax.swing.JMenuItem();
        relpreparto = new javax.swing.JMenuItem();
        rel_desempenho_vacas = new javax.swing.JMenuItem();
        rel_desempenho_touro = new javax.swing.JMenuItem();
        relproducao = new javax.swing.JMenu();
        utilitariosM = new javax.swing.JMenu();
        jMenuItem2 = new javax.swing.JMenuItem();
        trocarUsuarioM = new javax.swing.JMenuItem();
        BackupM = new javax.swing.JMenuItem();
        jMenuItem1 = new javax.swing.JMenuItem();

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

        logoTelaPrincipal.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/Logo_TelaPrincipal.png"))); // NOI18N

        painelAT.setBackground(new java.awt.Color(255, 255, 255));

        AT_Bovino.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_bovino.png"))); // NOI18N
        AT_Bovino.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_BovinoActionPerformed(evt);
            }
        });

        AT_USUARIO1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_usuario.png"))); // NOI18N
        AT_USUARIO1.setBorder(null);
        AT_USUARIO1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_USUARIO1ActionPerformed(evt);
            }
        });

        AT_fazenda.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_fazenda.png"))); // NOI18N
        AT_fazenda.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_fazendaActionPerformed(evt);
            }
        });

        AT_sair.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_sair.png"))); // NOI18N
        AT_sair.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_sairActionPerformed(evt);
            }
        });

        AT_backup.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_backup.png"))); // NOI18N
        AT_backup.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_backupActionPerformed(evt);
            }
        });

        AT_Cio.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_cio_novo.png"))); // NOI18N
        AT_Cio.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_CioActionPerformed(evt);
            }
        });

        AT_Confirmacao.setBackground(new java.awt.Color(51, 51, 51));
        AT_Confirmacao.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_cio_confirma.png"))); // NOI18N
        AT_Confirmacao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_ConfirmacaoActionPerformed(evt);
            }
        });

        AT_Repetiu.setBackground(new java.awt.Color(102, 102, 102));
        AT_Repetiu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_cio_repetiu.png"))); // NOI18N
        AT_Repetiu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_RepetiuActionPerformed(evt);
            }
        });

        AT_Perdeu.setBackground(new java.awt.Color(51, 51, 51));
        AT_Perdeu.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_perdeu.png"))); // NOI18N
        AT_Perdeu.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_PerdeuActionPerformed(evt);
            }
        });

        AT_Parto.setBackground(new java.awt.Color(51, 51, 51));
        AT_Parto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imagens/icones/at_parto.png"))); // NOI18N
        AT_Parto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                AT_PartoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout painelATLayout = new javax.swing.GroupLayout(painelAT);
        painelAT.setLayout(painelATLayout);
        painelATLayout.setHorizontalGroup(
            painelATLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelATLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(AT_USUARIO1, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(AT_fazenda, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(AT_Bovino, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(18, 18, 18)
                .addComponent(AT_Cio, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(AT_Repetiu, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(AT_Confirmacao, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(AT_Perdeu, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(AT_Parto, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(AT_backup, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(AT_sair, javax.swing.GroupLayout.PREFERRED_SIZE, 34, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
        );
        painelATLayout.setVerticalGroup(
            painelATLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(painelATLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(painelATLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(AT_Parto, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_Perdeu, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_Repetiu, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_Confirmacao, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_Cio, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_sair, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_backup, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_Bovino, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_fazenda, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(AT_USUARIO1, javax.swing.GroupLayout.PREFERRED_SIZE, 33, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jPanel1.setBackground(new java.awt.Color(255, 255, 255));

        jLabel1.setBackground(new java.awt.Color(255, 255, 255));
        jLabel1.setFont(new java.awt.Font("Arial Narrow", 1, 14)); // NOI18N
        jLabel1.setText("Usuário:");

        usuarioLogadoInfo.setFont(new java.awt.Font("Arial Unicode MS", 0, 14)); // NOI18N
        usuarioLogadoInfo.setText("jLabel1");

        jLabel2.setFont(new java.awt.Font("Arial Narrow", 1, 14)); // NOI18N
        jLabel2.setText("Fazenda:");

        fazendaLogada1.setFont(new java.awt.Font("Arial Unicode MS", 0, 14)); // NOI18N
        fazendaLogada1.setText("jLabel1");

        jLabel5.setFont(new java.awt.Font("Arial Narrow", 1, 14)); // NOI18N
        jLabel5.setText("Proprietário:");

        proLogada1.setFont(new java.awt.Font("Arial Unicode MS", 0, 14)); // NOI18N
        proLogada1.setText("jLabel1");

        dataValor.setFont(new java.awt.Font("Arial Unicode MS", 0, 14)); // NOI18N
        dataValor.setText("Data:");
        dataValor.addAncestorListener(new javax.swing.event.AncestorListener() {
            public void ancestorMoved(javax.swing.event.AncestorEvent evt) {
            }
            public void ancestorAdded(javax.swing.event.AncestorEvent evt) {
                dataValorAncestorAdded(evt);
            }
            public void ancestorRemoved(javax.swing.event.AncestorEvent evt) {
            }
        });

        DataL.setFont(new java.awt.Font("Arial Narrow", 1, 14)); // NOI18N
        DataL.setText("Data:");

        horasValor.setFont(new java.awt.Font("Arial Unicode MS", 0, 14)); // NOI18N
        horasValor.setText("horas");

        HoraL.setFont(new java.awt.Font("Arial Narrow", 1, 14)); // NOI18N
        HoraL.setText("Hora:");

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGap(21, 21, 21)
                .addComponent(jLabel1)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(usuarioLogadoInfo, javax.swing.GroupLayout.PREFERRED_SIZE, 114, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel2)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(fazendaLogada1, javax.swing.GroupLayout.PREFERRED_SIZE, 199, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jLabel5)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(proLogada1, javax.swing.GroupLayout.PREFERRED_SIZE, 253, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(DataL)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(dataValor, javax.swing.GroupLayout.PREFERRED_SIZE, 97, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(HoraL)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(horasValor, javax.swing.GroupLayout.PREFERRED_SIZE, 79, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(11, Short.MAX_VALUE))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(usuarioLogadoInfo)
                .addComponent(jLabel2, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(fazendaLogada1)
                .addComponent(jLabel5, javax.swing.GroupLayout.PREFERRED_SIZE, 25, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addComponent(proLogada1)
                .addComponent(dataValor)
                .addComponent(DataL)
                .addComponent(HoraL)
                .addComponent(horasValor))
        );

        menuBarra.setBackground(new java.awt.Color(102, 102, 102));

        cadastroM.setText("Cadastro");
        cadastroM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cadastroMActionPerformed(evt);
            }
        });

        bovinoM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_B, java.awt.event.InputEvent.CTRL_MASK));
        bovinoM.setText("Bovino");
        bovinoM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                bovinoMActionPerformed(evt);
            }
        });
        cadastroM.add(bovinoM);

        fazendaM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_F, java.awt.event.InputEvent.CTRL_MASK));
        fazendaM.setText("Fazenda");
        fazendaM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                fazendaMActionPerformed(evt);
            }
        });
        cadastroM.add(fazendaM);

        usuarioM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_U, java.awt.event.InputEvent.CTRL_MASK));
        usuarioM.setText("Usuário");
        usuarioM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                usuarioMActionPerformed(evt);
            }
        });
        cadastroM.add(usuarioM);

        menuBarra.add(cadastroM);

        eventosM.setText("Eventos");

        reproducaoM.setText("Reprodução");

        cadastroCioM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_C, java.awt.event.InputEvent.CTRL_MASK));
        cadastroCioM.setText("Cadastro de Cio");
        cadastroCioM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cadastroCioMActionPerformed(evt);
            }
        });
        reproducaoM.add(cadastroCioM);

        cioRepetidoM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_R, java.awt.event.InputEvent.SHIFT_MASK));
        cioRepetidoM.setText("Cio Repetido");
        cioRepetidoM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cioRepetidoMActionPerformed(evt);
            }
        });
        reproducaoM.add(cioRepetidoM);

        confirmaCioM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_C, java.awt.event.InputEvent.SHIFT_MASK));
        confirmaCioM.setText("Confirmaçao de Cio");
        confirmaCioM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                confirmaCioMActionPerformed(evt);
            }
        });
        reproducaoM.add(confirmaCioM);

        prePartoM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_P, java.awt.event.InputEvent.SHIFT_MASK));
        prePartoM.setText("Pre-Parto");
        prePartoM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                prePartoMActionPerformed(evt);
            }
        });
        reproducaoM.add(prePartoM);

        perdaCriaM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_P, java.awt.event.InputEvent.ALT_MASK));
        perdaCriaM.setText("Perda de Cria");
        perdaCriaM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                perdaCriaMActionPerformed(evt);
            }
        });
        reproducaoM.add(perdaCriaM);

        partoM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_P, java.awt.event.InputEvent.CTRL_MASK));
        partoM.setText("Parto");
        partoM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                partoMActionPerformed(evt);
            }
        });
        reproducaoM.add(partoM);

        eventosM.add(reproducaoM);

        menuBarra.add(eventosM);

        relatorioM.setText("Relatórios");

        relcadastro.setText("Cadastro");

        usuarioRel.setText("Relatorio Usuario");
        usuarioRel.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                usuarioRelActionPerformed(evt);
            }
        });
        relcadastro.add(usuarioRel);

        rel_cad_bov.setText("Relatorio Bovino");
        rel_cad_bov.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rel_cad_bovActionPerformed(evt);
            }
        });
        relcadastro.add(rel_cad_bov);

        relatorioM.add(relcadastro);

        rel_quanti_perdas.setText("Reproducao");
        rel_quanti_perdas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rel_quanti_perdasActionPerformed(evt);
            }
        });

        previsaoParto.setText("Previsão para Parto");
        previsaoParto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                previsaoPartoActionPerformed(evt);
            }
        });
        rel_quanti_perdas.add(previsaoParto);

        Cio_por_Vaca.setText("Cio por Vaca");
        Cio_por_Vaca.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                Cio_por_VacaActionPerformed(evt);
            }
        });
        rel_quanti_perdas.add(Cio_por_Vaca);

        relPreParto.setText("Previsão para Pré-Parto");
        relPreParto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                relPrePartoActionPerformed(evt);
            }
        });
        rel_quanti_perdas.add(relPreParto);

        relpreparto.setText("Vacas em Pré-Parto");
        relpreparto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                relprepartoActionPerformed(evt);
            }
        });
        rel_quanti_perdas.add(relpreparto);

        rel_desempenho_vacas.setText("Histórico geral Vacas");
        rel_desempenho_vacas.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rel_desempenho_vacasActionPerformed(evt);
            }
        });
        rel_quanti_perdas.add(rel_desempenho_vacas);

        rel_desempenho_touro.setText("Histórico geral Touros");
        rel_desempenho_touro.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                rel_desempenho_touroActionPerformed(evt);
            }
        });
        rel_quanti_perdas.add(rel_desempenho_touro);

        relatorioM.add(rel_quanti_perdas);

        relproducao.setText("Produção");
        relatorioM.add(relproducao);

        menuBarra.add(relatorioM);

        utilitariosM.setText("Utilitário");

        jMenuItem2.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_S, java.awt.event.InputEvent.ALT_MASK));
        jMenuItem2.setText("Sair");
        jMenuItem2.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem2ActionPerformed(evt);
            }
        });
        utilitariosM.add(jMenuItem2);

        trocarUsuarioM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_L, java.awt.event.InputEvent.ALT_MASK));
        trocarUsuarioM.setText("Trocar Usuário");
        trocarUsuarioM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                trocarUsuarioMActionPerformed(evt);
            }
        });
        utilitariosM.add(trocarUsuarioM);

        BackupM.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_B, java.awt.event.InputEvent.ALT_MASK));
        BackupM.setText("Backup");
        BackupM.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                BackupMActionPerformed(evt);
            }
        });
        utilitariosM.add(BackupM);

        jMenuItem1.setAccelerator(javax.swing.KeyStroke.getKeyStroke(java.awt.event.KeyEvent.VK_F12, 0));
        jMenuItem1.setText("Suporte");
        jMenuItem1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jMenuItem1ActionPerformed(evt);
            }
        });
        utilitariosM.add(jMenuItem1);

        menuBarra.add(utilitariosM);

        setJMenuBar(menuBarra);

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(painelAT, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(logoTelaPrincipal, javax.swing.GroupLayout.PREFERRED_SIZE, 210, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap())
            .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addComponent(painelAT, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 260, Short.MAX_VALUE)
                .addComponent(logoTelaPrincipal, javax.swing.GroupLayout.PREFERRED_SIZE, 107, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(39, 39, 39)
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
        );

        setSize(new java.awt.Dimension(1061, 546));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents
    public void setIcon() {
        setIconImage(Toolkit.getDefaultToolkit().getImage(getClass().getResource("/Imagens/LogoRCIcon.png")));
    }
    private void jMenuItem2ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem2ActionPerformed
        System.exit(0); // TODO add your handling code here:
    }//GEN-LAST:event_jMenuItem2ActionPerformed

    private void usuarioMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_usuarioMActionPerformed
        // TODO add your handling code here:
        TelaCadastroUsuario telaU = new TelaCadastroUsuario();
        telaU.setVisible(true);
        telaU.setTitle("RC MILK - CADASTRAR USUÁRIO");
    }//GEN-LAST:event_usuarioMActionPerformed

    private void trocarUsuarioMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_trocarUsuarioMActionPerformed
        Tela_login telaL = new Tela_login();
        this.dispose();
        telaL.setVisible(true);// TODO add your handling code here:
    }//GEN-LAST:event_trocarUsuarioMActionPerformed


    private void bovinoMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_bovinoMActionPerformed
        TelaCadastroBovino telaB = new TelaCadastroBovino();
        telaB.setTitle("RC MILK - CADASTRAR BOVINO");
        telaB.setVisible(true);
        // TODO add your handling code here:
    }//GEN-LAST:event_bovinoMActionPerformed

    private void cadastroMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cadastroMActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_cadastroMActionPerformed

    private void fazendaMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_fazendaMActionPerformed
        TelaCadastroFazenda telaF = new TelaCadastroFazenda();
        telaF.setTitle("RC MILK - CADASTRAR FAZENDA");
        telaF.setVisible(true);  // TODO add your handling code here:
    }//GEN-LAST:event_fazendaMActionPerformed

    private void jMenuItem1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jMenuItem1ActionPerformed
        String sql = "select nome_usuario,telefone,email from tb_usuario where id_usuario = 1";
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
            rs.next();
            Icon figura = new ImageIcon(getToolkit().createImage(getClass().getResource("/Imagens/suporte.png")));
            JOptionPane.showMessageDialog(null, "Entre em contato com:\nSuporte: " + rs.getString("nome_usuario")
                    + "\nTelefone: " + rs.getString("telefone") + "\nE-mail: "
                    + rs.getString("email"), "RC MILK - SUPORTE", JOptionPane.PLAIN_MESSAGE, figura);
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
    }//GEN-LAST:event_jMenuItem1ActionPerformed

    private void BackupMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_BackupMActionPerformed

        try {
            PostgresBackup.realizaBackup();
        } catch (IOException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        } catch (InterruptedException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_BackupMActionPerformed

    private void AT_BovinoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_BovinoActionPerformed
        TelaCadastroBovino telaB = new TelaCadastroBovino();
        telaB.setTitle("RC MILK - CADASTRAR BOVINOS");
        telaB.setVisible(true);          // TODO add your handling code here:
    }//GEN-LAST:event_AT_BovinoActionPerformed

    private void AT_fazendaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_fazendaActionPerformed
        TelaCadastroFazenda telaF = new TelaCadastroFazenda();
        telaF.setTitle("RC MILK - CADASTRAR FAZENDA");
        telaF.setVisible(true);        // TODO add your handling code here:
    }//GEN-LAST:event_AT_fazendaActionPerformed

    private void AT_sairActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_sairActionPerformed
        System.exit(0);        // TODO add your handling code here:
    }//GEN-LAST:event_AT_sairActionPerformed

    private void AT_backupActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_backupActionPerformed
        try {
            PostgresBackup.realizaBackup();
        } catch (IOException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        } catch (InterruptedException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }        // TODO add your handling code here:
    }//GEN-LAST:event_AT_backupActionPerformed

    private void AT_USUARIO1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_USUARIO1ActionPerformed
        TelaCadastroUsuario telaU = new TelaCadastroUsuario();
        telaU.setVisible(true);
        telaU.setTitle("RC MILK - CADASTRO USUARIOS");        // TODO add your handling code here:
    }//GEN-LAST:event_AT_USUARIO1ActionPerformed

    private void AT_CioActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_CioActionPerformed
        TelaCadastroCio telaC = new TelaCadastroCio();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE CIOS");        // TODO add your handling code here:
    }//GEN-LAST:event_AT_CioActionPerformed

    private void cadastroCioMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cadastroCioMActionPerformed
        TelaCadastroCio telaC = new TelaCadastroCio();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE CIO");
    }//GEN-LAST:event_cadastroCioMActionPerformed

    private void cioRepetidoMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cioRepetidoMActionPerformed
        TelaRepetiuCio telaC = new TelaRepetiuCio();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE CIO REPETIDO");
    }//GEN-LAST:event_cioRepetidoMActionPerformed

    private void confirmaCioMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_confirmaCioMActionPerformed
        TelaConfirmacaoDeCio telaC = new TelaConfirmacaoDeCio();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - CONFIRMAR CIO");
    }//GEN-LAST:event_confirmaCioMActionPerformed

    private void prePartoMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_prePartoMActionPerformed
        TelaPreParto telaC = new TelaPreParto();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE PRÉ-PARTO");
    }//GEN-LAST:event_prePartoMActionPerformed

    private void perdaCriaMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_perdaCriaMActionPerformed
        TelaPerdaCria telaC = new TelaPerdaCria();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE PERDA DE CRIA");
    }//GEN-LAST:event_perdaCriaMActionPerformed

    private void partoMActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_partoMActionPerformed
        TelaParto telaC = new TelaParto();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE PARTO");
    }//GEN-LAST:event_partoMActionPerformed

    private void AT_ConfirmacaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_ConfirmacaoActionPerformed
        TelaConfirmacaoDeCio telaC = new TelaConfirmacaoDeCio();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - CONFIRMAR CIO");
    }//GEN-LAST:event_AT_ConfirmacaoActionPerformed

    private void AT_RepetiuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_RepetiuActionPerformed
        TelaRepetiuCio telaC = new TelaRepetiuCio();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE CIO REPETIDO");
    }//GEN-LAST:event_AT_RepetiuActionPerformed

    private void AT_PerdeuActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_PerdeuActionPerformed
        TelaPerdaCria telaC = new TelaPerdaCria();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE PERDA DE CRIA");
    }//GEN-LAST:event_AT_PerdeuActionPerformed

    private void AT_PartoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_AT_PartoActionPerformed
        TelaParto telaC = new TelaParto();
        telaC.setVisible(true);
        telaC.setTitle("RC MILK - REGISTRAR EVENTO DE PARTO");
    }//GEN-LAST:event_AT_PartoActionPerformed

    private void rel_cad_bovActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rel_cad_bovActionPerformed
        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null, rs1 = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("SELECT tb_bovino.cod AS tb_bovino_cod,tb_bovino.ativo AS tb_bovino_ativo,tb_bovino.nome AS tb_bovino_nome,tb_bovino.brinco AS tb_bovino_brinco,tb_bovino.idade AS tb_bovino_idade,tb_bovino.sexo AS tb_bovino_sexo,tb_bovino.raca AS tb_bovino_raca,tb_bovino.cor AS tb_bovino_cor,tb_bovino.quantcria AS tb_bovino_quantcria,tb_bovino.observacao AS tb_bovino_observacao,tb_bovino.nome_pai AS tb_bovino_nome_pai,tb_bovino.nome_mae AS tb_bovino_nome_mae,tb_bovino.data_nasc AS tb_bovino_data_nasc,tb_fazenda.id_fazenda AS tb_fazenda_id_fazenda,tb_fazenda.ativo AS tb_fazenda_ativo,tb_fazenda.nome_fazenda AS tb_fazenda_nome_fazenda,tb_fazenda.nome_prop AS tb_fazenda_nome_prop,tb_fazenda.cfp_prop AS tb_fazenda_cfp_prop,tb_fazenda.insc_estadual AS tb_fazenda_insc_estadual,tb_fazenda.telefone AS tb_fazenda_telefone,tb_fazenda.celular AS tb_fazenda_celular,tb_fazenda.email AS tb_fazenda_email FROM public.tb_bovino tb_bovino,public.tb_fazenda tb_fazenda;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {

            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_cadastro_bovinos.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_rel_cad_bovActionPerformed

    private void usuarioRelActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_usuarioRelActionPerformed
        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("select id_usuario,ativo,nome_usuario,usuario,telefone,email from tb_usuario;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {

            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_cadastro_usuario.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }

    }//GEN-LAST:event_usuarioRelActionPerformed

    private void rel_quanti_perdasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rel_quanti_perdasActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_rel_quanti_perdasActionPerformed

    private void rel_desempenho_touroActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rel_desempenho_touroActionPerformed
        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("SELECT  c.codtouro, bov.nome, bov.brinco, bov.sexo,bov.raca,bov.cor, bov.data_nasc,\n"
                + "		count(codcio) as Quant_Cios,\n"
                + "		SUM(CASE c.repetiucio WHEN TRUE THEN 1 ELSE 0 END) as Quant_Cios_rep,\n"
                + "		SUM(CASE c.parto WHEN TRUE THEN 1 ELSE 0 END) as Quant_Cios_partos,\n"
                + "		SUM(CASE c.perdeu WHEN TRUE THEN 1 ELSE 0 END) as Quant_Cios_Perdidos,\n"
                + "		(COUNT(c.codcio)  - (SUM(CASE c.repetiucio WHEN TRUE THEN 1 ELSE 0 END)+\n"
                + "						  SUM(CASE c.parto WHEN TRUE THEN 1 ELSE 0 END)+\n"
                + "						  SUM(CASE c.perdeu WHEN TRUE THEN 1 ELSE 0 END))) as Quant_cios_Confirmados_Sem_Finalizar\n"
                + "FROM tb_cio as c inner join tb_bovino as bov on c.codtouro = bov.cod\n"
                + "GROUP BY c.codtouro,bov.cod\n"
                + "ORDER BY c.codtouro;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {
            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_desempenho_touro.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_rel_desempenho_touroActionPerformed

    private void rel_desempenho_vacasActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_rel_desempenho_vacasActionPerformed
        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("SELECT  c.codvaca, bov.nome, bov.brinco, bov.idade,bov.raca,bov.cor, bov.data_nasc,\n"
                + "		count(codcio) as Quant_Cios,\n"
                + "		SUM(CASE c.repetiucio WHEN TRUE THEN 1 ELSE 0 END) as Quant_Cios_rep,\n"
                + "		SUM(CASE c.parto WHEN TRUE THEN 1 ELSE 0 END) as Quant_Cios_partos,\n"
                + "		SUM(CASE c.perdeu WHEN TRUE THEN 1 ELSE 0 END) as Quant_Cios_Perdidos,\n"
                + "		(COUNT(c.codcio)  - (SUM(CASE c.repetiucio WHEN TRUE THEN 1 ELSE 0 END)+\n"
                + "						  SUM(CASE c.parto WHEN TRUE THEN 1 ELSE 0 END)+\n"
                + "						  SUM(CASE c.perdeu WHEN TRUE THEN 1 ELSE 0 END))) as Quant_cios_Confirmados_Sem_Finalizar\n"
                + "FROM tb_cio as c inner join tb_bovino as bov on c.codvaca = bov.cod\n"
                + "GROUP BY c.codvaca,bov.cod\n"
                + "ORDER BY c.codvaca;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {
            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_desempenho_vacas.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_rel_desempenho_vacasActionPerformed

    private void relprepartoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_relprepartoActionPerformed

        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("select codcio, nomevaca, previsao_parto, data_preparto  from tb_cio where pre_parto = true and finalizado <> true;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {
            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_pre_parto.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_relprepartoActionPerformed

    private void relPrePartoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_relPrePartoActionPerformed
        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("select nomevaca , previsao_parto - 60 as DATA_PARA_PRE_PARTO , previsao_parto from tb_cio where confirmado = true and finalizado <> true;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {
            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_planejamento_pre_parto.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_relPrePartoActionPerformed

    private void Cio_por_VacaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_Cio_por_VacaActionPerformed
        TelaRelatorioDeCioPorVacas telaRC = new TelaRelatorioDeCioPorVacas();
        telaRC.setVisible(true);
        telaRC.IniciaTabela();
        telaRC.setTitle("RC MILK - Relatorio de Cio");
    }//GEN-LAST:event_Cio_por_VacaActionPerformed

    private void previsaoPartoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_previsaoPartoActionPerformed
        Connection con = null;
        PreparedStatement pst = null;
        ResultSet rs = null;
        try {
            con = Conec.Conectar();
        } catch (ClassNotFoundException e) {
            Logger.getLogger(Bovino.class.getName()).log(Level.SEVERE, null, e);
        }
        String sql = ("SELECT codcio, datacio, codvaca, nomevaca, codtouro, nometouro, confirmado, dataconfirmacao, repetiucio, obs, perdeu, dataparto, parto, dataperda, finalizado, pre_parto, data_preparto, previsao_parto FROM tb_cio WHERE tb_cio.finalizado = false;");
        try {
            pst = con.prepareStatement(sql);
            rs = pst.executeQuery();
        } catch (SQLException E) {
            JOptionPane.showMessageDialog(null, E);
        }
        try {
            JRResultSetDataSource resultset = new JRResultSetDataSource(rs);
            Map map = null;
            String url = "src\\Relatorios\\rel_reproducao_previsao_parto.jasper";
            System.out.println(url);
            JasperPrint jasperPrint = JasperFillManager.fillReport(url, map, resultset);
            JasperViewer jasperViewer = new JasperViewer(jasperPrint, false);
            jasperViewer.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(TelaPrincipal.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_previsaoPartoActionPerformed
    class hora implements ActionListener {

        public void actionPerformed(ActionEvent e) {
            Calendar horaCaptura = Calendar.getInstance();

            horasValor.setText(String.format("%1$tH:%1$tM:%1$tS", horaCaptura));
        }
    }
    private void dataValorAncestorAdded(javax.swing.event.AncestorEvent evt) {//GEN-FIRST:event_dataValorAncestorAdded
        // TODO add your handling code here:
    }//GEN-LAST:event_dataValorAncestorAdded

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaPrincipal.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TelaPrincipal().setVisible(true);
            }
        });
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton AT_Bovino;
    private javax.swing.JButton AT_Cio;
    private javax.swing.JButton AT_Confirmacao;
    private javax.swing.JButton AT_Parto;
    private javax.swing.JButton AT_Perdeu;
    private javax.swing.JButton AT_Repetiu;
    private javax.swing.JButton AT_USUARIO1;
    private javax.swing.JButton AT_backup;
    private javax.swing.JButton AT_fazenda;
    private javax.swing.JButton AT_sair;
    private javax.swing.JMenuItem BackupM;
    private javax.swing.JMenuItem Cio_por_Vaca;
    private javax.swing.JLabel DataL;
    private javax.swing.JLabel HoraL;
    private javax.swing.JMenuItem bovinoM;
    private javax.swing.JMenuItem cadastroCioM;
    private javax.swing.JMenu cadastroM;
    private javax.swing.JMenuItem cioRepetidoM;
    private javax.swing.JMenuItem confirmaCioM;
    private javax.swing.JLabel dataValor;
    private javax.swing.JMenu eventosM;
    public javax.swing.JLabel fazendaLogada1;
    private javax.swing.JMenuItem fazendaM;
    private javax.swing.JLabel horasValor;
    private com.toedter.calendar.JDayChooser jDayChooser1;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel5;
    private javax.swing.JMenuItem jMenuItem1;
    private javax.swing.JMenuItem jMenuItem2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JLabel logoTelaPrincipal;
    private javax.swing.JMenuBar menuBarra;
    private javax.swing.JPanel painelAT;
    private javax.swing.JMenuItem partoM;
    private javax.swing.JMenuItem perdaCriaM;
    private javax.swing.JMenuItem prePartoM;
    private javax.swing.JMenuItem previsaoParto;
    public javax.swing.JLabel proLogada1;
    private javax.swing.JMenuItem relPreParto;
    private javax.swing.JMenuItem rel_cad_bov;
    private javax.swing.JMenuItem rel_desempenho_touro;
    private javax.swing.JMenuItem rel_desempenho_vacas;
    private javax.swing.JMenu rel_quanti_perdas;
    private javax.swing.JMenu relatorioM;
    private javax.swing.JMenu relcadastro;
    private javax.swing.JMenuItem relpreparto;
    private javax.swing.JMenu relproducao;
    private javax.swing.JMenu reproducaoM;
    private javax.swing.JMenuItem trocarUsuarioM;
    public javax.swing.JLabel usuarioLogadoInfo;
    private javax.swing.JMenuItem usuarioM;
    private javax.swing.JMenuItem usuarioRel;
    private javax.swing.JMenu utilitariosM;
    // End of variables declaration//GEN-END:variables

}
